{% extends "base.html" %} {% block title %}{{ output.va.name.full }} Details{%
endblock %} {% block body_class %}va-details{% endblock %} {% block body_data
%}data-va-id="{{ va_id }}"{% endblock %} {% block content %}

<div class="row">
    <div class="col-sm-4 col-lg-3">
        <img
            src="{{ output.va.image.large }}"
            alt="{{ output.va.name.full }}"
            class="img-fluid"
        />
    </div>
    <div class="col-sm-8 col-lg-9">
        <h1>{{ output.va.name.full }}</h1>

        <p>
            Gender: {{ output.va.gender }}<br />
            Age: {{ output.va.age }}<br />
            Date of Birth: {{ output.va.dateOfBirth.day }}-{{
            output.va.dateOfBirth.month}}-{{ output.va.dateOfBirth.year }}
        </p>
    </div>
</div>
<div class="row">
    <div class="col-sm-6"><h3>Roles:</h3></div>
    <div class="col-sm-6">
        <select id="sort-select">
            <option value="seasonYear">Sort by season year</option>
            <option value="popularity">Sort by popularity</option>
            <option value="averageScore">Sort by average score</option>
        </select>
    </div>
</div>
<div class="row roles"></div>
<!-- Temporary section to display the full output string -->
<div>
    <pre>{{ output }}</pre>
</div>

{% endblock %} {% block extra_js %}
<script>
    var vaId = $('body').data('va-id');
    console.log('Script is running, va id:', vaId);

    // Set empty charMedia
    let charMedia;

    getCharacterMedia(vaId).then((media) => {
        charMedia = media;
        let sortedMedia = sortMedia(charMedia, 'node.seasonYear', 'desc');
        displayCharacterMedia(sortedMedia);
    });

    document
        .getElementById('sort-select')
        .addEventListener('change', function () {
            let sortBy = this.value;
            let sortedMedia = sortMedia(charMedia, sortBy, 'desc');
            // First clear the current display
            $('.roles').empty();
            // Then display the sorted media
            displayCharacterMedia(sortedMedia);
        });
</script>
{% endblock %}
